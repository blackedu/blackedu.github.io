# 交叉熵
交叉熵的计算公式为：
$$
    E' = -\frac{1}{n}\sum_i ^ n (y_i \ln \hat y_i + (1-y_i)\ln(1-\hat y_i))
$$
为什么交叉熵可以作为损失函数，最小化交叉熵函数等价于误差最小化，预测的概率最大？

假如有三个箱子，第一个箱子打开是苹果的概率为0.7， 第二个打开是梨的概率为0.8，第三个香蕉的概率为0.2，不是香蕉的概率为0.8.那么拆开箱子的所有可能性为：

|  | 苹果 | 梨 | 香蕉 |
| --- | --- | --- | --- |
| 第一个箱子 | 0.7 | 0.2 | 0.1 |
| 第二个箱子 | 0.5 | 0.1 | 0.4 |
| 第三个箱子 | 0.1 | 0.8 | 0.1 |

于是箱子中水果的可能性为：

|   | 苹果 | 梨 | 香蕉 | 概率 | 交叉熵 |
| --- | --- | --- | --- | --- | --- |
| 苹果/梨/香蕉  | 0.7 | 0.1 | 0.1 | 0.007 |  |
| 苹果/苹果/香蕉 | 0.7 | 0.5 | 0.1 | 0.035 |  |
| 苹果/梨/苹果 | 0.7 | 0.1 | 0.1 | 0.007 |  |
| 梨/梨/香蕉 | 0.7 | 0.2 | 0.8 |  |  |
| 苹果/苹果/梨 | 0.7 | 0.5 | 0.8 | 0.28 |  |
| 苹果/梨/香蕉 | 0.3 | 0.8 | 0.8 |  |  |
| 苹果/梨/香蕉 | 0.3 | 0.2 | 0.2 |  |  |
| 苹果/梨/香蕉 | 0.3 | 0.2 | 0.8 |  |  |


$$
    p(苹果|苹果|香蕉) = 0.7 \times 0.5 \times 0.8=0.28\\
    CE(苹果|苹果|香蕉)=-(\ln0.7+\ln0.5+\ln0.8) = -1.273
$$

